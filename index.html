<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moon Orbit Visualizer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: black;
            color: white;
        }
        canvas {
            display: block;
        }
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
        }
        .control-label {
            margin-bottom: 5px;
            display: block;
        }
        input, button {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <label for="initialDirectionX" class="control-label">Initial X Direction:</label>
        <input type="number" id="initialDirectionX" value="1" class="control-input">
        
        <label for="initialDirectionY" class="control-label">Initial Y Direction:</label>
        <input type="number" id="initialDirectionY" value="0" class="control-input">
        
        <label for="initialPosX" class="control-label">Initial X Position (meters):</label>
        <input type="number" id="initialPosX" value="384400000" class="control-input">
        
        <label for="initialPosY" class="control-label">Initial Y Position (meters):</label>
        <input type="number" id="initialPosY" value="0" class="control-input">
        
        <label for="initialVelocity" class="control-label">Initial Velocity (m/s):</label>
        <input type="number" id="initialVelocity" value="1023.056" class="control-input">
        
        <button onclick="startSimulation()">Start Simulation</button>
    </div>

    <script>
        // Gravitational constant and Earth parameters
        const G = 6.67430e-11;    // Gravitational constant (m^3 kg^-1 s^-2)
        const earthMass = 5.9722e24; // Earth's mass (kg)
        const earthRadius = 6371;  // Earth's radius in km
        const moonRadius = 1737;   // Moon's radius in km
        let timeStep = 10;         // Time step for simulation (in seconds)

        let moonPosX, moonPosY, moonVelX, moonVelY;  // Variables for moon's position and velocity
        let trajectoryData = [];  // Store trajectory data for visualization

        // Unit vector calculation (normalization)
        function normalizeVector(x, y) {
            let magnitude = Math.sqrt(x * x + y * y);
            return { x: x / magnitude, y: y / magnitude };
        }

        // Gravitational force calculation
        function calculateGravitationalForce(x, y) {
            let r = Math.sqrt(x * x + y * y);  // Distance from Earth to Moon
            return (G * earthMass) / (r * r);   // F = G * (M / r^2)
        }

        function startSimulation() {
            // Get input values
            let initialDirectionX = parseFloat(document.getElementById('initialDirectionX').value);
            let initialDirectionY = parseFloat(document.getElementById('initialDirectionY').value);
            let initialPosX = parseFloat(document.getElementById('initialPosX').value);
            let initialPosY = parseFloat(document.getElementById('initialPosY').value);
            let initialVelocity = parseFloat(document.getElementById('initialVelocity').value);

            // Normalize direction to get the unit vector
            let unitDirection = normalizeVector(initialDirectionX, initialDirectionY);

            // Initial position and velocity vectors (with direction scaled by velocity)
            moonPosX = initialPosX;
            moonPosY = initialPosY;
            moonVelX = unitDirection.x * initialVelocity;
            moonVelY = unitDirection.y * initialVelocity;

            // Clear previous trajectory data
            trajectoryData = [];

            // Run the simulation
            runOrbitSimulation();
        }

        function runOrbitSimulation() {
            trajectoryData = [];  // Clear previous data
            let steps = 1000; // Number of simulation steps

            // Simulate orbit for a given number of steps
            for (let i = 0; i < steps; i++) {
                let force = calculateGravitationalForce(moonPosX, moonPosY);

                // Update velocity based on gravitational acceleration
                moonVelX -= force * moonPosX / Math.sqrt(moonPosX * moonPosX + moonPosY * moonPosY);
                moonVelY -= force * moonPosY / Math.sqrt(moonPosX * moonPosX + moonPosY * moonPosY);

                // Update position
                moonPosX += moonVelX * timeStep;
                moonPosY += moonVelY * timeStep;

                // Store the new position in the trajectory data
                trajectoryData.push([moonPosX, moonPosY]);

                // Visualize the trajectory in real-time
                if (i % 10 === 0) {  // Update the canvas every 10 iterations for smoother animation
                    drawTrajectory(trajectoryData);
                }
            }
        }

        function drawTrajectory(data) {
            // Clear the previous frame
            clear();
            background(0);

            // Scale factor to adjust the positions for the canvas size
            const scale = 0.00000005;  // You can adjust this scale as needed
            const canvasCenterX = width / 2;
            const canvasCenterY = height / 2;

            // Draw the Earth (as a small circle at the center)
            fill(0, 0, 255);  // Earth color (blue)
            ellipse(canvasCenterX, canvasCenterY, earthRadius * 2 * scale, earthRadius * 2 * scale);

            // Draw the Moon trajectory (Red color)
            fill(255, 0, 0);
            for (let i = 0; i < data.length; i++) {
                let [x, y] = data[i];
                let canvasX = x * scale + canvasCenterX;
                let canvasY = y * scale + canvasCenterY;
                ellipse(canvasX, canvasY, 5, 5);  // Draw the moon as a small red dot
            }
        }

        function setup() {
            createCanvas(windowWidth, windowHeight);
            noStroke();
        }
    </script>
</body>
</html>



